<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN" "archivearticle.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id><journal-title>BMC Bioinformatics</journal-title><issn pub-type="epub">1471-2105</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">16336688</article-id><article-id pub-id-type="pmc">1369007</article-id><article-id pub-id-type="publisher-id">1471-2105-6-293</article-id><article-id pub-id-type="doi">10.1186/1471-2105-6-293</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methodology Article</subject></subj-group></article-categories><title-group><article-title>An algorithm for automatic evaluation of the spot quality in two-color DNA microarray experiments</article-title></title-group><contrib-group><contrib id="A1" corresp="yes" contrib-type="author"><name><surname>Novikov</surname><given-names>Eugene</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>Eugene.Novikov@curie.fr</email></contrib><contrib id="A2" contrib-type="author"><name><surname>Barillot</surname><given-names>Emmanuel</given-names></name><xref ref-type="aff" rid="I1">1</xref><email>Emmanuel.Barillot@curie.fr</email></contrib></contrib-group><aff id="I1"><label>1</label>Service Bioinformatique, Institut Curie, 26 Rue d'Ulm, 75248 Paris Cedex 05, France.</aff><pub-date pub-type="collection"><year>2005</year></pub-date><pub-date pub-type="epub"><day>9</day><month>12</month><year>2005</year></pub-date><volume>6</volume><fpage>293</fpage><lpage>293</lpage><ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/6/293"/><history><date date-type="received"><day>17</day><month>6</month><year>2005</year></date><date date-type="accepted"><day>9</day><month>12</month><year>2005</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2005 Novikov and Barillot; licensee BioMed Central Ltd.</copyright-statement><copyright-year>2005</copyright-year><copyright-holder>Novikov and Barillot; licensee BioMed Central Ltd.</copyright-holder><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0"><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Novikov
               Eugene
               
               Eugene.Novikov@curie.fr
            </dc:author><dc:title>
            An algorithm for automatic evaluation of the spot quality in two-color DNA microarray experiments
         </dc:title><dc:date>2005</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 6(1): 293-. (2005)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2005)6:1&#x0003c;293&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>--></license></permissions><abstract><sec><title>Background</title><p>Although DNA microarray technologies are very powerful for the simultaneous quantitative characterization of thousands of genes, the quality of the obtained experimental data is often far from ideal. The measured microarrays images represent a regular collection of spots, and the intensity of light at each spot is proportional to the DNA copy number or to the expression level of the gene whose DNA clone is spotted. Spot quality control is an essential part of microarray image analysis, which must be carried out at the level of individual spot identification. The problem is difficult to formalize due to the diversity of instrumental and biological factors that can influence the result.</p></sec><sec><title>Results</title><p>For each spot we estimate the ratio of measured fluorescence intensities revealing differential gene expression or change in DNA copy numbers between the test and control samples. We also define a set of quality characteristics and a model for combining these characteristics into an overall spot quality value. We have developed a training procedure to evaluate the contribution of each individual characteristic in the overall quality. This procedure uses information available from replicated spots, located in the same array or over a set of replicated arrays. It is assumed that unspoiled replicated spots must have very close ratios, whereas poor spots yield greater diversity in the obtained ratio estimates.</p></sec><sec><title>Conclusion</title><p>The developed procedure provides an automatic tool to quantify spot quality and to identify different types of spot deficiency occurring in DNA microarray technology. Quality values assigned to each spot can be used either to eliminate spots or to weight contribution of each ratio estimate in follow-up analysis procedures.</p></sec></abstract></article-meta></front><body><sec><title>Background</title><p>In comparative DNA microarray experiments compared test and control samples are labeled with different fluorescent dyes (typically the red-fluorescent Cy5 and the green-fluorescent Cy3), mixed up and co-hybridized with the DNA clones regularly spotted on the microarray. The array is scanned at a high spatial resolution at the corresponding fluorescent wavelengths, and the fluorescence intensities are recorded in two color channels (Cy5 and Cy3) for each pixel. The ratio of the measured intensities (Cy5/Cy3) for each microarray spot reveals either differential gene expression (cDNA technology [<xref ref-type="bibr" rid="B1">1</xref>]) or change in DNA copy numbers (comparative genome hybridization (CGH) technology [<xref ref-type="bibr" rid="B2">2</xref>]) between the test and control samples for the corresponding gene. Each ratio estimate should be accompanied by some measure of quality demonstrating the level confidence in the obtained ratios.</p><p>The main components of the microarray image analysis pipeline for spots include localization, quantification and quality control. Among these, quality control is the least formalized and least developed. To determine spot quality we need to have a clear definition of a good spot, or a list of all possible distortions that may spoil the spot. The diversity of instrumental platforms and instrumental and biological factors that may influence the result makes formalization difficult and unlikely to be universal.</p><p>In this paper, we consider the problem of quantifying spot quality in comparative DNA microarray experiments. Several attempts have been made to approach the problem [<xref ref-type="bibr" rid="B3">3</xref>-<xref ref-type="bibr" rid="B7">7</xref>]. Generally a number of parameters characterizing the spot, such as signal-to-noise ratio, size, circularity, etc., are introduced. These parameters have to be combined into an overall quality value to be used as a confidence level in the follow-up analysis. There are different methods for deriving such a parameter. For example, in two studies [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>], it was assumed that individual quality scores contribute equivalently to the composite quality score. This may not be true, depending on the instrumental setup and experimental design. Therefore we need an approach that allows us to evaluate the weights that control the input of each of the marginal quality characteristics into the overall score. For that, different training procedures, in which the user classified a set of representative spots into three (accepted, rejected or intermediate spots) [<xref ref-type="bibr" rid="B3">3</xref>] or four (bad, close to bad, close to good or good spots) [<xref ref-type="bibr" rid="B7">7</xref>] groups, were proposed. This requires an expert to evaluate at least a couple of hundred spots to achieve a good approximation, which is a difficult and time-consuming task.</p><p>Here, we develop an automatic training procedure to evaluate the contribution (or weight) of each marginal quality characteristic into the overall quality score, together with an original set of quality characteristics and a model that maps this set into an overall quality value. This procedure is based on information from replicated spots, located on the same array or over a set of replicated arrays, and assumes that unspoiled replicated spots must have very close intensity ratios, whereas poor spots yield greater diversity in the obtained ratio estimates. The obtained weights can then be used to establish a critical limit for each quality characteristic, such that if a spot's characteristic exceeds its critical limit, the spot can be declared a "bad" spot.</p><p>We demonstrate the applicability of the developed algorithms using simulated artificial images and experimental images of different array designs used within our Institute and CGH images obtained from the UCSF Cancer Center.</p></sec><sec><title>Results</title><p>We assume that the spots are identified and well localized [<xref ref-type="bibr" rid="B8">8</xref>], (Novikov E, Barillot E: unpublished data)] in squares (called spot cells). This involves: (i) identifying the position of each spot on the array to associate it with the spotted clone; and (ii) establishing the borders between the neighboring spots to allow further independent data processing (extracting quantitative information) for each spot. Visually this results in the generation of a grid covering the microarray image.</p><sec><title>Ratio estimation</title><p>We have implemented [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>] two approaches for calculating the Cy5/Cy3 ratio for the spot: (i) based on spot segmentation and (ii) based on linear regression.</p><sec><title>Spot segmentation</title><p>In the spot segmentation approach a direct arithmetic ratio of the background-corrected fluorescence intensity estimates in the two color channels is evaluated. This approach requires the identification of both the foreground &#x02013; the measured spot &#x02013; and the background &#x02013; typically the level of non-specific hybridization. The segmentation procedure, in our implementation, is based on the <italic>k</italic>-means adaptive pixel-clustering algorithm [<xref ref-type="bibr" rid="B10">10</xref>] modified to explicitly take into consideration the geometrical constraints on the spots and to improve identification of the background areas for the spots with smooth edges.</p></sec><sec><title>Linear regression estimation</title><p>In the linear regression approach, the ratio is represented as the slope of the linear regression fit of the pixel intensities in two color channels (Figs. <xref ref-type="fig" rid="F1">1</xref> and <xref ref-type="fig" rid="F2">2</xref>). As measured fluorescence intensities are statistically distorted in both color channels, orthogonal regression [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B12">12</xref>] is used to estimate the slope. In this method spot segmentation is unnecessary, as background pixels are concentrated at the origin of the linear regression plot and do not influence the slope of the regression line (Fig. <xref ref-type="fig" rid="F1">1</xref>). However, outlier or aberrant pixels within the spot cells, even in small numbers, can strongly influence the regression line, thus biasing the ratio. We have improved [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>] the linear regression approach by developing a statistical filtering procedure that systematically searches and removes aberrant or outlier pixels.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p><bold>Example of a spot with a low <italic>DW </italic>parameter (0.45). </bold>Although the coefficient of determination of the linear regression plot (red line) is relatively high (0.92), it is obvious that the linear regression model is not appropriate in this case. It is possible that there are contributions (blue lines) from two different species occurring within the given spot, leading to two different Cy5/Cy3 ratios. The background pixels are grouped near the origin of the linear regression plot (cyan circle).</p></caption><graphic xlink:href="1471-2105-6-293-1"/></fig><fig position="float" id="F2"><label>Figure 2</label><caption><p><bold>Example of a spot with contamination. </bold>The filtering procedure removes aberrant pixels (dots with the red contours), improving the Cy5/Cy3 ratio estimation and increasing the coefficient of determination of the linear regression plot. Before filtering (red line): <italic>CD </italic>= 0.86; linear regression ratio is 1.41; segmentation ratio is 0.712. After filtering (black line): <italic>CD </italic>= 0.91; linear regression ratio is 0.275; segmentation ratio is 0.273. However, larger amounts of aberrant pixels may result in a less reliable estimation.</p></caption><graphic xlink:href="1471-2105-6-293-2"/></fig><p>Briefly, this procedure can be outlined as follows. Suspicious pixels are examined by evaluating the quality of the linear regression fit with and without the suspicious pixel. We quantify the fit quality by the residual variance, <italic>s</italic><sup>2 </sup>[<xref ref-type="bibr" rid="B13">13</xref>]. The smaller <italic>s</italic><sup>2 </sup>is, the closer the linear regression line is to the experimental data. The ratio of the <italic>s</italic><sup>2 </sup>values is calculated for the fit with the tested pixel and for the fit without. If this ratio is larger than a critical value of the <italic>F</italic>-distribution at a user-defined confidence level, the pixel will be marked as aberrant. We select pixels with the highest intensity in either of two channels first and then select pixels having the largest deviation from the fitted regression line. To take into account the fact that the distortions caused by pixels from the top of the intensity scale and by pixels lying off of the linear regression line, may be different, we apply different confidence levels for the <italic>F</italic>-statistics for these pixels.</p><p>For the high-intensity pixels we also perform another test to determine how far their intensities are from the averaged intensity of the other pixels within the spot cell. This detects pixels, far away from the other pixels, that do not distort the linear regression line. Although these pixels may not change the Cy5/Cy3 ratio, they could be considered as aberrant pixels, as we expect to see an almost continuous distribution of pixels intensity.</p><p>The procedure performs iteratively until no more aberrant pixels are detected. An example of the outlier detection is presented in Fig. <xref ref-type="fig" rid="F2">2</xref>. Note that the regression approach is capable of detecting contamination pixels that are geometrically inseparable from the spot. Therefore, the developed procedure can be considered not only as a procedure for correcting ratio recovery, but also as a procedure to repair the spot and to improve the quality of experimental material. It requires, however, that the contamination clearly deviates from the straight regression line, which is defined by the majority of "good" pixels from the spot.</p><p>Although this procedure gives a high level of confidence in the linear regression ratio estimates, we still apply spot segmentation, because linear regression estimates may be biased when there is a high level of statistical noise (low correlation between the Cy3 and Cy5 color channels). However, after removing aberrant pixels, the segmentation algorithm also gives more robust estimates, and there is a greater agreement in the ratio values obtained with both methods.</p><p>As well as the Cy5/Cy3 ratio estimates, each of these approaches generates a series of parameters that can be used to evaluate the spot quality.</p></sec></sec><sec><title>Quality characteristics</title><p>We define a set of quality parameters, characterizing different features of the spot. These parameters are scaled between 0 (bad spot) and 1 (good spot) to facilitate further quality analysis.</p><p>First, we use the characteristics from the linear regression approach. The <bold>coefficient of determination </bold>(<italic>CD </italic>= <italic>r</italic><sup>2</sup>, where <italic>r </italic>is the correlation coefficient) of linear regression signifies the degree of linear relationship between the intensities in the Cy3 and Cy5 channels. High values of <italic>CD </italic>(approaching 1) are expected for good spots. Low values suggest either relatively bright but non-correlated contamination, or strong statistical noise normally characterizing low-level (or missing) spots. Although the removal of aberrant pixels increases the <italic>CD </italic>of linear regression, it can still be low for noisy spots. These spots must be either flagged out or assigned a lower quality value. This parameter takes the range [0;1]: <italic>q</italic><sub><italic>1</italic></sub>(<italic>CD</italic>) = <italic>CD</italic>.</p><p>The <bold>Durbin-Watson statistic </bold>(<italic>DWS</italic>) [<xref ref-type="bibr" rid="B14">14</xref>] evaluates the presence of the first-order autocorrelation in the residuals of the linear regression fit. It ranges from 0 to 4, 0 being a positive correlation and 4 being a negative correlation. A <italic>DWS </italic>value close to two indicates that the residuals are uncorrelated and the model is appropriate. Large deviations from two, resulting from systematic patterns in the residuals plot suggest that the spot cannot be modeled in terms of a simple linear regression. Low <italic>DWS </italic>values typically imply strong contamination that was not removed by filtering (Fig. <xref ref-type="fig" rid="F1">1</xref>). The Durbin-Watson quality parameter (<italic>q</italic><sub>2 </sub>&#x02208; [0;1]) is obtained from the <italic>DWS </italic>value by the following transformation: <italic>q</italic><sub><italic>2</italic></sub>(<italic>DWS</italic>) = <italic>1 </italic>- |<italic>DWS </italic>- <italic>2</italic>|/<italic>2</italic>.</p><p>One more indicator of the quality directly available from the linear regression is the number (<italic>N</italic>) of the aberrant pixels flagged out by the filtering procedure. Although aberrant pixels can be found everywhere within the spot cell, we count only those pixels within the spot contours. This value can be used as a quantitative measure of <bold>spot contamination</bold>. Small numbers of aberrant pixels do not influence intensity ratio estimates, whereas the removal of large numbers of pixels from the spot may indicate inconsistency with the linear regression model (Fig. <xref ref-type="fig" rid="F2">2</xref>). We scale <italic>N </italic>to fit the range [0;1] as: <italic>q</italic><sub><italic>3</italic></sub>(<italic>N</italic>) = <italic>1 </italic>- <italic>N/S</italic>, where <italic>S </italic>is the number of pixels within the spot contour.</p><p>We now define three quality parameters from the analysis of the contoured spot. The <bold>diameter </bold>of the spot is calculated as <italic>D </italic>= <italic>2</italic>(<italic>S/&#x003c0;</italic>)<sup><italic>1/2</italic></sup>. As the true value for the spot diameter may be difficult to establish, we use a typical value taken as the median diameter over all spots on the array. Spots with exceptionally small diameters should normally be penalized. We define the diameter quality parameter as <italic>q</italic><sub><italic>4</italic></sub>(<italic>D</italic>) = <italic>exp{D-T}</italic>, if <italic>D </italic>&#x0003c;<italic>T </italic>and <italic>q</italic><sub><italic>4</italic></sub>(<italic>D</italic>) = <italic>1</italic>, if <italic>D </italic>&#x0003e; <italic>T</italic>, where <italic>T </italic>is the typical diameter.</p><p>The <bold>geometrical symmetry </bold>parameter measures deviation of the contoured spot from the ideal circle. The center and the diameter of the ideal circle correspond to the center and the diameter of the real spot. We divide both the real spot and the ideal circle into eight segments (pie slices defined as [<italic>k&#x003c0;</italic>/4;<italic>(k </italic>+ <italic>1)&#x003c0;</italic>/4], <italic>k </italic>= 0,...,7) and we count the number of pixels belonging to the spot (<italic>N</italic><sub><italic>si</italic></sub>, <italic>i </italic>= 1,...,8) and to the circle (<italic>N</italic><sub><italic>ci</italic></sub>, <italic>i </italic>= 1,...,8) for each segment. The sum of the absolute relative differences <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-6-293-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>G</mml:mi><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>8</mml:mn></mml:munderover><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow/></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow/></mml:msubsup></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow/></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGhbWrcqWGtbWucqGH9aqpdaaeWbqaamaalyaabaWaaqWaaeaacqWGobGtdaqhaaWcbaGaem4CamNaemyAaKgabaaaaOGaeyOeI0IaemOta40aa0baaSqaaiabdogaJjabdMgaPbqaaaaaaOGaay5bSlaawIa7aaqaaiabd6eaonaaDaaaleaacqWGJbWycqWGPbqAaeaaaaaaaaqaaiabdMgaPjabg2da9iabigdaXaqaaiabiIda4aqdcqGHris5aaaa@46CB@</mml:annotation></mml:semantics></mml:math></inline-formula> is then taken as an indicator of quality. For ideal circular spots <italic>GS </italic>should approach 0, whereas highly deformed (un-circular) spots can be recognized by high <italic>GS </italic>values (Fig. <xref ref-type="fig" rid="F3">3A</xref>). We transform the <italic>GS </italic>values as <italic>q</italic><sub><italic>5</italic></sub>(<italic>GS</italic>) = <italic>exp</italic>(-<italic>GS</italic>) to fit the range [0;1].</p><fig position="float" id="F3"><label>Figure 3</label><caption><p><bold>Examples of spots with different types of distortions. </bold>A) Large deviation from the circular shape (<italic>GS </italic>= 1.6); B) Bright piece of contamination within a larger circular spot, resulting in a low value of the <italic>IS </italic>parameter (<italic>IS </italic>= 1.71); C) Merged spots (<italic>UB </italic>= 2.98).</p></caption><graphic xlink:href="1471-2105-6-293-3"/></fig><p>Using the same partition of the spot into eight segments, we can also calculate the mean intensities for each of the segments (<italic>I</italic><sub><italic>i</italic></sub>, <italic>i </italic>= 1,...,8). The <bold>intensity symmetry </bold>of the spot is defined as <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-6-293-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>I</mml:mi><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>8</mml:mn></mml:munderover><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mrow/></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:mi>I</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGjbqscqWGtbWucqGH9aqpdaaeWbqaamaalyaabaWaaqWaaeaacqWGjbqsdaqhaaWcbaGaemyAaKgabaaaaOGaeyOeI0IaemysaKeacaGLhWUaayjcSdaabaGaemysaKeaaaWcbaGaemyAaKMaeyypa0JaeGymaedabaGaeGioaGdaniabggHiLdaaaa@3F95@</mml:annotation></mml:semantics></mml:math></inline-formula>, where <italic>I </italic>is the mean intensity within the spot. We scale the <italic>IS </italic>values in the range [0;1] as <italic>q</italic><sub><italic>6</italic></sub>(<italic>IS</italic>) = <italic>exp</italic>(-<italic>IS</italic>). Although a spot may have perfect circular shape, it may contain very bright (or dark) and highly concentrated groups of pixels originating from pieces of dust or other contamination (Fig. <xref ref-type="fig" rid="F3">3B</xref>). <italic>IS </italic>is calculated for each of two channels (Cy3 and Cy5) and the maximal value is taken as a final estimate.</p><p>We estimate two Cy5/Cy3 ratios; one by the linear regression approach (<italic>RR</italic>), and the other by the segmentation algorithm (<italic>RS</italic>). Despite the different methods of estimation, the variation between the two obtained ratios should be as small as possible. Consistent results should be expected, as most of the contaminating pixels have been removed by the filtering procedure. Large variations between the two estimates may indicate a problematic spot. Therefore, we use the <bold>coefficient of variation of two ratio estimates </bold><italic>CVR </italic>= <italic>2</italic><sup><italic>1/2</italic></sup>|<italic>RR-RS</italic>|/(<italic>RR</italic>+<italic>RS</italic>) as a characteristic of quality. The <italic>CVR </italic>quality parameter is defined as <italic>q</italic><sub><italic>7</italic></sub>(<italic>CVR</italic>) = <italic>exp</italic>(-<italic>CVR</italic>) fitting the range [0;1]. This measure of quality is the least explicit of all the quality characteristics: we can only determine that there is big discrepancy between the estimates but not why there is a big discrepancy, unless it is accompanied by lower values in any of the other quality parameters.</p><p>Finally, we introduce two parameters evaluating the quality of the background estimates. The first is the <bold>uniformity of the background </bold>(<italic>UB</italic>) around the spot, more precisely, along the grid lines separating neighborhood spots. We divide the grid line surrounding the spot into eight segments and calculate the mean intensity in each segment (<italic>B</italic><sub><italic>i</italic></sub>, <italic>i </italic>= 1,...,8). The <italic>UB </italic>parameter is defined as: <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-6-293-i3" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>U</mml:mi><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>8</mml:mn></mml:munderover><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mi>B</mml:mi><mml:mi>i</mml:mi><mml:mrow/></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:mi>B</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGvbqvcqWGcbGqcqGH9aqpdaaeWbqaamaalyaabaWaaqWaaeaacqWGcbGqdaqhaaWcbaGaemyAaKgabaaaaOGaeyOeI0IaemOqaieacaGLhWUaayjcSdaabaGaemOqaieaaaWcbaGaemyAaKMaeyypa0JaeGymaedabaGaeGioaGdaniabggHiLdaaaa@3F61@</mml:annotation></mml:semantics></mml:math></inline-formula>, where <italic>B </italic>is the mean intensity for the whole grid line around the spot. Normally we would not expect to observe a big variability in the fluorescence intensity in the background areas. Large <italic>UB </italic>values may discover presence of relatively bright contamination around the spot, large variability in the background or merged neighboring spots (Fig. <xref ref-type="fig" rid="F3">3C</xref>). <italic>UB </italic>is rescaled to the range [0;1] by the exponential transformation: <italic>q</italic><sub><italic>8</italic></sub>(<italic>UB</italic>) = <italic>exp</italic>(-<italic>UB</italic>).</p><p>The second background quality characteristic is the <bold>absolute level of the background </bold>(<italic>AB</italic>). We calculated this from the local area around the spot. As for the spot diameter <italic>D</italic>, there is no predefined ideal value for the absolute background. Therefore, as a benchmark for comparisons, we take the typical value as the median background level over all spots on the array. Spots with exceptionally high <italic>AB </italic>values should be treated with care or discarded. Of two background estimates obtained in two-color microarray experiments, we use one that gives the highest value as the most indicative of possible problems. We define the <italic>AB </italic>quality parameter as <italic>q</italic><sub><italic>9</italic></sub>(<italic>AB</italic>) = <italic>exp</italic>{-(<italic>AB</italic>-<italic>B</italic>)/<italic>B</italic>}, if <italic>AB </italic>&#x0003e; <italic>B </italic>and <italic>q</italic><sub><italic>9</italic></sub>(<italic>AB</italic>) = <italic>1</italic>, if <italic>AB </italic>&#x0003c;<italic>B</italic>, where <italic>B </italic>is the typical background level.</p><p>We cannot claim that the developed quality parameters are the optimal. However, they have led to reasonable results for most of the experimental and simulated situations we tested. Of course, there may be a possibility to formalize some of these parameters more precisely and/or to develop new parameters accounting for other types of distortions.</p></sec><sec><title>Spot quality analysis</title><p>We consider two aims of spot quality analysis. The first is to combine the nine marginal quality parameters into an overall quality value. This value can be used either to flag out directly spots with a quality lower than a user-defined threshold, or, in the follow-up image analysis procedures (normalization, classification, clustering, etc.) as a parameter characterizing the level of confidence in the obtained Cy5/Cy3 ratios. The second aim is to identify a critical range (a sort of a confidence interval) for each quality characteristic. If a certain quality characteristic of the spot falls in this range, the corresponding spot could be classified as a "bad" spot.</p><sec><title>Overall quality</title><p>We used the following definition for the overall quality value:</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-6-293-i4" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>min</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1...9</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mrow/></mml:msubsup></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGrbqucqGH9aqpdaWfqaqaaiGbc2gaTjabcMgaPjabc6gaUbWcbaGaemyAaKMaeyypa0JaeGymaeJaeiOla4IaeiOla4IaeiOla4IaeGyoaKdabeaakmaacmaabaGaemyCae3aa0baaSqaaiabdMgaPbqaaiabdEha3naaDaaameaacqWGPbqAaeaaaaaaaaGccaGL7bGaayzFaaGaeiilaWIaaCzcaiaaxMaacqGGOaakcqaIXaqmcqGGPaqkaaa@4733@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>where <italic>q</italic><sub><italic>i </italic></sub>= <italic>q</italic><sub><italic>i</italic></sub>(<italic>x</italic><sub><italic>i</italic></sub>) &#x02208; [0;1], <italic>i </italic>= 1,...,9 are the marginal quality parameters for <italic>x</italic><sub><italic>1 </italic></sub>= <italic>CD</italic>, <italic>x</italic><sub><italic>2 </italic></sub>= <italic>DWS</italic>, <italic>x</italic><sub><italic>3 </italic></sub>= <italic>N</italic>, <italic>x</italic><sub><italic>4 </italic></sub>= <italic>D</italic>, <italic>x</italic><sub><italic>5 </italic></sub>= <italic>GS</italic>, <italic>x</italic><sub><italic>6 </italic></sub>= <italic>IS</italic>, <italic>x</italic><sub><italic>7 </italic></sub>= <italic>CVR</italic>, <italic>x</italic><sub><italic>8 </italic></sub>= <italic>UB</italic>, <italic>x</italic><sub><italic>9 </italic></sub>= <italic>AB</italic>, and <italic>w</italic><sub><italic>i </italic></sub>are the weights that control the input of the corresponding quality components into the overall quality value. A link between the weight <italic>w</italic><sub><italic>i </italic></sub>and the critical value <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-6-293-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>lim</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG4baEdaqhaaWcbaGaemyAaKgajeaybaGagiiBaWMaeiyAaKMaeiyBa0gaaaaa@3435@</mml:annotation></mml:semantics></mml:math></inline-formula> can be established for each quality characteristic <italic>i </italic>= 1,...,9:</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-6-293-i6" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mrow/></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>log</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow/><mml:mrow><mml:mi>lim</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mrow/></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>lim</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mtext>&#x02009;</mml:mtext><mml:mtext>&#x02009;</mml:mtext><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mtext>&#x02009;</mml:mtext><mml:mtext>&#x02009;</mml:mtext><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>lim</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>q</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow/><mml:mrow><mml:mi>lim</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow/><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mrow/></mml:msubsup></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG3bWDdaqhaaWcbaGaemyAaKgabaaaaOGaeyypa0ZaaSaaaeaacyGGSbaBcqGGVbWBcqGGNbWzdaGadaqaaiabdgfarnaaDaaaleaaaeaacyGGSbaBcqGGPbqAcqGGTbqBaaaakiaawUhacaGL9baaaeaacyGGSbaBcqGGVbWBcqGGNbWzdaGadaqaaiabdghaXnaaDaaaleaacqWGPbqAaeaaaaGcdaqadaqaaiabdIha4naaDaaaleaacqWGPbqAaeaacyGGSbaBcqGGPbqAcqGGTbqBaaaakiaawIcacaGLPaaaaiaawUhacaGL9baaaaGaeiilaWIaaGPaVlaaykW7ieaacqWFVbWBcqWFYbGCcaaMc8UaaGPaVlabdIha4naaDaaaleaacqWGPbqAaeaacyGGSbaBcqGGPbqAcqGGTbqBaaGccqGH9aqpcqWGXbqCdaqhaaWcbaGaemyAaKgabaGaeyOeI0IaeGymaedaaOWaaeWaaeaadaGadaqaaiabdgfarnaaDaaaleaaaeaacyGGSbaBcqGGPbqAcqGGTbqBaaaakiaawUhacaGL9baadaqhaaWcbaaabaGaeGymaeJaei4la8Iaem4DaC3aa0baaWqaaiabdMgaPbqaaaaaaaaakiaawIcacaGLPaaacqGGSaalcaWLjaGaaCzcaiabcIcaOiabikdaYiabcMcaPaaa@7891@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>where <italic>Q</italic><sup>lim </sup>&#x02208; [0;1] is the user-defined overall quality threshold, and <italic>q</italic><sub><italic>i</italic></sub>(<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-6-293-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>lim</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG4baEdaqhaaWcbaGaemyAaKgajeaybaGagiiBaWMaeiyAaKMaeiyBa0gaaaaa@3435@</mml:annotation></mml:semantics></mml:math></inline-formula>) is the quality parameter calculated for <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-6-293-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>lim</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG4baEdaqhaaWcbaGaemyAaKgajeaybaGagiiBaWMaeiyAaKMaeiyBa0gaaaaa@3435@</mml:annotation></mml:semantics></mml:math></inline-formula>. The critical value <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-6-293-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>lim</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG4baEdaqhaaWcbaGaemyAaKgajeaybaGagiiBaWMaeiyAaKMaeiyBa0gaaaaa@3435@</mml:annotation></mml:semantics></mml:math></inline-formula> sets up the limit such that if a certain characteristic <italic>i </italic>exceeds this limit, the corresponding quality parameter <italic>q</italic><sub><italic>i</italic></sub>(<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-6-293-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>lim</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG4baEdaqhaaWcbaGaemyAaKgajeaybaGagiiBaWMaeiyAaKMaeiyBa0gaaaaa@3435@</mml:annotation></mml:semantics></mml:math></inline-formula>) will become lower than <italic>Q</italic><sup>lim</sup>. The correspondence between <italic>x</italic><sub><italic>i</italic></sub>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-6-293-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>lim</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG4baEdaqhaaWcbaGaemyAaKgajeaybaGagiiBaWMaeiyAaKMaeiyBa0gaaaaa@3435@</mml:annotation></mml:semantics></mml:math></inline-formula>, <italic>q</italic><sub><italic>i</italic></sub>(<italic>x</italic><sub><italic>i</italic></sub>), <italic>q</italic><sub><italic>i</italic></sub>(<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-6-293-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>lim</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG4baEdaqhaaWcbaGaemyAaKgajeaybaGagiiBaWMaeiyAaKMaeiyBa0gaaaaa@3435@</mml:annotation></mml:semantics></mml:math></inline-formula>), <italic>w</italic><sub><italic>i</italic></sub>, <italic>Q </italic>and <italic>Q</italic><sup>lim </sup>is demonstrated in Fig. <xref ref-type="fig" rid="F4">4</xref>.</p><fig position="float" id="F4"><label>Figure 4</label><caption><p>The correspondence between the quality characteristics, quality parameters and overall quality value.</p></caption><graphic xlink:href="1471-2105-6-293-4"/></fig></sec><sec><title>Quality weights <italic>w</italic><sub><italic>i</italic></sub></title><p>The experimental quality parameters <italic>q</italic><sub><italic>i</italic></sub>, <italic>i </italic>= 1,...,9 are directly available from the quantification procedure, whereas the weights <italic>w</italic><sub><italic>i </italic></sub>(or the critical values <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-6-293-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>lim</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG4baEdaqhaaWcbaGaemyAaKgajeaybaGagiiBaWMaeiyAaKMaeiyBa0gaaaaa@3435@</mml:annotation></mml:semantics></mml:math></inline-formula>) are unknown and are not easily guessed or derived from theory. Therefore, the problem of spot quality analysis becomes a problem of weights (<italic>w</italic><sub><italic>i</italic></sub>) estimation. This can only be solved if additional information is available. Here we consider three possibilities:</p><p>1. The additional information may come, for example, from the user expertise. The user has to classify the spots manually [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B7">7</xref>] and assign a quality value to each spot from a representative subset. These values are then used for training the model (1) leading to a combination of the weights (<italic>w</italic><sub><italic>i</italic></sub>) such that the overall quality values reproduce the user classification reasonably well.</p><p>2. We can manually apply different combinations of the weights <italic>w</italic><sub><italic>i </italic></sub>and visually appreciate, which spots have been flagged out. The trials must be continued until most of the user classified "bad" spots are eliminated by the chosen combinations of the weights.</p><p>3. The weights can be estimated automatically using information available from replicated spots on the same array or over a set of replicated arrays. Unspoiled replicate spots should have very similar estimated Cy5/Cy3 ratio values. Large differences between the observed ratios in the replicate spots would signal that some spots from this replicate were irregular. We formalize this approach by first defining the quality value for the replicate:</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-6-293-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>k</mml:mi><mml:mrow/></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>min</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1...</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow/></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGrbqudaqhaaWcbaGaem4AaSgabaaaaOGaeyypa0ZaaCbeaeaacyGGTbqBcqGGPbqAcqGGUbGBaSqaaiabdQgaQjabg2da9iabigdaXiabc6caUiabc6caUiabc6caUiabd6gaUbqabaGcdaGadaqaaiabdgfarnaaDaaaleaacqWGRbWAcqWGQbGAaeaaaaaakiaawUhacaGL9baacqGGSaalcaWLjaGaaCzcaiabcIcaOiabiodaZiabcMcaPaaa@4755@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>where <italic>k </italic>indicates the replicates, <italic>n </italic>is the number of spots in a replicate and <italic>Q</italic><sub><italic>kj </italic></sub>is a spot quality value given by Eq. (1). Substituting Eq. (1) into (3) yields</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-6-293-i8" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>k</mml:mi><mml:mrow/></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>min</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1...</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:mi>min</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1...9</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>q</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGrbqudaqhaaWcbaGaem4AaSgabaaaaOGaeyypa0ZaaCbeaeaacyGGTbqBcqGGPbqAcqGGUbGBaSqaaiabdQgaQjabg2da9iabigdaXiabc6caUiabc6caUiabc6caUiabd6gaUbqabaGcdaGadaqaamaaxababaGagiyBa0MaeiyAaKMaeiOBa4galeaacqWGPbqAcqGH9aqpcqaIXaqmcqGGUaGlcqGGUaGlcqGGUaGlcqaI5aqoaeqaaOWaaiWaaeaacqWGXbqCdaqhaaWcbaGaem4AaSMaemOAaOMaemyAaKgabaGaem4DaC3aaSbaaWqaaiabdMgaPbqabaaaaaGccaGL7bGaayzFaaaacaGL7bGaayzFaaGaeiilaWIaaCzcaiaaxMaacqGGOaakcqaI0aancqGGPaqkaaa@5984@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>where <italic>q</italic><sub><italic>kji </italic></sub>is the <italic>i</italic>-th quality parameter of the <italic>j</italic>-th replicated spot in the <italic>k</italic>-th replicate. The weights <italic>w</italic><sub><italic>i</italic></sub>, <italic>i </italic>= 1,...,9 are the parameters that ensure the best fit of the experimental quality values (<italic>Q</italic><sub><italic>k </italic></sub><italic>versus V</italic><sub><italic>k</italic></sub>) to a user-defined ideal quality curve <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>), where <italic>V</italic><sub><italic>k </italic></sub>is the intensity ratio variation coefficient in the <italic>k</italic>-th replicate. The best fit of <italic>Q</italic><sub><italic>k</italic></sub>(<italic>V</italic><sub><italic>k</italic></sub>) to <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>) can be achieved by minimizing the sum of squared differences between <italic>Q</italic><sub><italic>k</italic></sub>(<italic>V</italic><sub><italic>k</italic></sub>) and <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>) (least-squares fit):</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1471-2105-6-293-i9" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mi>&#x003c8;</mml:mi><mml:mi>k</mml:mi><mml:mrow/></mml:msubsup><mml:msubsup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>k</mml:mi><mml:mrow/></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:munder><mml:mrow><mml:mi>min</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1...</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:munder><mml:mrow><mml:mi>min</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1...9</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>q</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle><mml:mo>,</mml:mo><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaaeqbqaaiabeI8a5naaDaaaleaacqWGRbWAaeaaaaGcdaWadaqaaiabdAgaMjabcIcaOiabdAfawnaaDaaaleaacqWGRbWAaeaaaaGccqGGPaqkcqGHsisldaWfqaqaaiGbc2gaTjabcMgaPjabc6gaUbWcbaGaemOAaOMaeyypa0JaeGymaeJaeiOla4IaeiOla4IaeiOla4IaemOBa4gabeaakmaacmaabaWaaCbeaeaacyGGTbqBcqGGPbqAcqGGUbGBaSqaaiabdMgaPjabg2da9iabigdaXiabc6caUiabc6caUiabc6caUiabiMda5aqabaGcdaGadaqaaiabdghaXnaaDaaaleaacqWGRbWAcqWGQbGAcqWGPbqAaeaacqWG3bWDdaWgaaadbaGaemyAaKgabeaaaaaakiaawUhacaGL9baaaiaawUhacaGL9baaaiaawUfacaGLDbaadaqhaaWcbaaabaGaeGOmaidaaaqaaiabdUgaRbqab0GaeyyeIuoakiabcYcaSiaaxMaacaWLjaGaeiikaGIaeGynauJaeiykaKcaaa@6674@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>where &#x003c8;<sub><italic>k </italic></sub>are the weights of the contribution of each replicate into the sum (5). The quality weights <italic>w</italic><sub><italic>i </italic></sub>can be estimated by minimization of Eq (5) using one of the algorithms for non-linear fitting [<xref ref-type="bibr" rid="B15">15</xref>].</p></sec><sec><title>Ideal quality curve <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>)</title><p><italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>) defines how fast the overall quality of the replicates should decrease with increasing ratio variation. The shape of the ideal quality curve <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>) is somewhat arbitrary; the only requirement is that it should demonstrate monotonic decay. Further formalization for <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>) is hardly possible until more information regarding the ideal quality behavior becomes available. Therefore we have to look for empirical approaches to define <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>). For example, <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>) can be implemented as a non-parametric function, which can be constructed by the user through the properly designed user interface. <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>) can also be represented as a function (such as <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>) = <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1471-2105-6-293-i10" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mi>k</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGwbGvdaqhaaWcbaGaem4AaSgabaGaeqySdegaaaaa@310C@</mml:annotation></mml:semantics></mml:math></inline-formula> exp{-&#x003b2;<italic>V</italic><sub><italic>k</italic></sub>} with two adjustable parameters &#x003b1; and &#x003b2;), which can yield different shapes depending on the parameters values. Finally, a library of different functional shapes for <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>) can be created. In our work we follow the third approach: three shapes were implemented for testing:</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1471-2105-6-293-i11" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>exp</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>exp</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGMbGzcqGGOaakcqWGwbGvdaWgaaWcbaGaem4AaSgabeaakiabcMcaPiabg2da9maaceaabaqbaeqabmqaaaqaaiGbcwgaLjabcIha4jabcchaWnaacmaabaGaeyOeI0IaemOvay1aaSbaaSqaaiabdUgaRbqabaGccqGGVaWlcuWGwbGvgaqeaaGaay5Eaiaaw2haaiabcYcaSiabbccaGiabcIcaOiabdggaHjabcMcaPaqaaiGbcwgaLjabcIha4jabcchaWnaacmaabaGaeyOeI0IaemOvay1aa0baaSqaaiabdUgaRbqaaiabikdaYaaakiabc+caViqbdAfawzaaraWaaWbaaSqabeaacqaIYaGmaaaakiaawUhacaGL9baacqGGSaalcqqGGaaicqGGOaakcqWGIbGycqGGPaqkaeaadaWcgaqaaiabigdaXaqaamaacmaabaGaeGymaeJaey4kaSIaemOvay1aaSbaaSqaaiabdUgaRbqabaGccqGGVaWlcuWGwbGvgaqeaaGaay5Eaiaaw2haaiabcYcaSiabbccaGiabcIcaOiabdogaJjabcMcaPaaaaaaacaGL7baacaWLjaGaaCzcaiabcIcaOiabiAda2iabcMcaPaaa@6B4E@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>and for each shape only the characteristic ratio variation coefficient <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1471-2105-6-293-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGwbGvgaqeaaaa@2DF9@</mml:annotation></mml:semantics></mml:math></inline-formula> must be predefined. A typical example of the quality plot with the exponential <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>) (Eq. (6),a) is shown in Fig. <xref ref-type="fig" rid="F5">5</xref>.</p><fig position="float" id="F5"><label>Figure 5</label><caption><p><bold>Quality plots (<italic>Q</italic><sub><italic>k </italic></sub>versus <italic>V</italic><sub><italic>k</italic></sub>) for image 7A. </bold><italic>Green dots </italic>&#x02013; using only the CD quality parameter; <italic>red dots </italic>&#x02013; using only the <italic>CRV </italic>quality parameter; <italic>blue dots </italic>&#x02013; using overall quality parameter <italic>Q</italic>. The black solid line is the exponential ideal quality curve <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>) (Eq. (6),a). Three triplicates showing poor quality (outlined by circles) are given in the insets. The main characteristics of the spots from the selected triplicates are given in Table 3.</p></caption><graphic xlink:href="1471-2105-6-293-5"/></fig><p>In our quality analysis algorithm, user participation is limited to the definition of the ideal quality curve shape <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>). This is somewhat simpler than deciding on the quality of several hundred spots, which is used to teach the algorithm in the manual approach. However, as with other solutions, this algorithm requires representative images to train the model. It is impossible to evaluate confidently the weight of the contribution of the diameter quality parameter, for example, if all spots in the array have the same diameter. Therefore, a careful selection of training images containing a realistic diversity of all possible distortions and artifacts is needed.</p></sec><sec><title>Fitting weights &#x003c8;<sub><italic>k</italic></sub></title><p>An important issue of the minimization of Eq (5) is reasonable selection of the fitting weights &#x003c8;<sub><italic>k</italic></sub>. The easiest way is to set all &#x003c8;<sub><italic>k </italic></sub>equal to one. However, most of the replicates are often observed in the initial part of the quality plot (high-quality spots), whereas there may be only a few replicates in the tail of the plot (poor-quality spots). In this case, equalized weights would give a very accurate fit for the initial part of the quality curve while ignoring the tail. However, mainly the tail contains the relevant information (spots with different distortions and artifacts) for identifying the quality weights. Therefore, we try to increase the input from regions with a smaller number of replicates by defining the weights &#x003c8;<sub><italic>k </italic></sub>in the following way:</p><p>1. All replicates are sorted according to their ratio variation <italic>V</italic><sub><italic>k</italic></sub>.</p><p>2. The set of sorted replicates is divided into bins with ten replicates in each bin. The difference <italic>&#x003bb;</italic><sub><italic>j </italic></sub>between the smallest and the largest ratio variation coefficients in each bin <italic>j </italic>is calculated. The larger this difference, the smaller the concentration of the replicates in the given region of the quality plot.</p><p>3. The weights &#x003c8;<sub><italic>k </italic></sub>for Eq. (5) are then calculated as &#x003c8;<sub><italic>k </italic></sub>= &#x003c8;<sub><italic>j</italic>*10+<italic>i </italic></sub>= <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1471-2105-6-293-i13" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>&#x003bb;</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqaH7oaBdaqhaaWcbaGaemOAaOgabaGaeGimaaJaeiOla4IaeGynaudaaaaa@32B4@</mml:annotation></mml:semantics></mml:math></inline-formula>, <italic>i </italic>= 0,...,9. That is, they are equalized for ten replicates from the same bin <italic>j</italic>.</p></sec><sec><title>Follow-up image analysis</title><p>As it was mentioned earlier, the overall quality value, <italic>Q </italic>(Eq. (1)), can be used as a parameter characterizing the level of confidence in the obtained Cy5/Cy3 ratios. If, for example, <italic>n </italic>ratios should be averaged, the weighted mean would ensure a more robust estimate for the average:</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1471-2105-6-293-i14" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>l</mml:mi><mml:mrow/></mml:msubsup><mml:msubsup><mml:mi>R</mml:mi><mml:mi>l</mml:mi><mml:mrow/></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>l</mml:mi><mml:mrow/></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>7</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGsbGugaqeaiabg2da9maalaaabaWaaabCaeaacqWGrbqudaqhaaWcbaGaemiBaWgabaaaaOGaemOuai1aa0baaSqaaiabdYgaSbqaaaaaaeaacqWGSbaBcqGH9aqpcqaIXaqmaeaacqWGUbGBa0GaeyyeIuoaaOqaamaaqahabaGaemyuae1aa0baaSqaaiabdYgaSbqaaaaaaeaacqWGSbaBcqGH9aqpcqaIXaqmaeaacqWGUbGBa0GaeyyeIuoaaaGccqGGSaalcaWLjaGaaCzcaiabcIcaOiabiEda3iabcMcaPaaa@4A0A@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>where <italic>R</italic><sub><italic>l </italic></sub>is the Cy5/Cy3 ratio and <italic>Q</italic><sub><italic>l</italic></sub>, is the corresponding overall quality value (<italic>l </italic>= 1,...,<italic>n</italic>). The weighted coefficient of variation is defined as</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1471-2105-6-293-i15" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>l</mml:mi><mml:mrow/></mml:msubsup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mi>l</mml:mi><mml:mrow/></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>l</mml:mi><mml:mrow/></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mrow></mml:msqrt></mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mfrac><mml:mo>.</mml:mo><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>8</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGwbGvcqGH9aqpdaWcaaqaamaakaaabaWaaSGbaeaadaaeWbqaaiabdgfarnaaDaaaleaacqWGSbaBaeaaaaGcdaqadaqaaiabdkfasnaaDaaaleaacqWGSbaBaeaaaaGccqGHsislcuWGsbGugaqeaaGaayjkaiaawMcaamaaCaaaleqabaGaeGOmaidaaaqaaiabdYgaSjabg2da9iabigdaXaqaaiabd6gaUbqdcqGHris5aaGcbaWaaabCaeaacqWGrbqudaqhaaWcbaGaemiBaWgabaaaaaqaaiabdYgaSjabg2da9iabigdaXaqaaiabd6gaUbqdcqGHris5aaaaaSqabaaakeaacuWGsbGugaqeaaaacqGGUaGlcaWLjaGaaCzcaiabcIcaOiabiIda4iabcMcaPaaa@505A@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>Note that the ratio variation coefficient <italic>V</italic><sub><italic>k </italic></sub>from Eq. (5) can be determined from Eq. (8), if we set <italic>Q</italic><sub><italic>l </italic></sub>= 1, <italic>l </italic>= 1,...,<italic>n</italic>, with <italic>n </italic>being the number of spots in the <italic>k</italic>-th replicate.</p></sec></sec><sec><title>Image simulation</title><p>In [<xref ref-type="bibr" rid="B9">9</xref>] we have described the Monte-Carlo simulation model for generating artificial microarray images. The advantage of using artificial images is that we always know the exact Cy5/Cy3 ratio values. This allows us to test and compare objectively different image analysis algorithms. The general model for the two-color (Cy3, Cy5) microarray image is given by [<xref ref-type="bibr" rid="B9">9</xref>]:</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1471-2105-6-293-i16" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>y</mml:mi><mml:mn>3</mml:mn></mml:mrow><mml:mrow/></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow/><mml:mi>s</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow/><mml:mi>s</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow/><mml:mi>d</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow/><mml:mi>d</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>,</mml:mo><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>9</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGgbGrdaqhaaWcbaGaem4qamKaemyEaKNaeG4mamdabaaaaOGaeiikaGIaemiEaGNaeiilaWIaemyEaKNaeiykaKIaeyypa0ZaaabCaeaacqWGNbWzdaqadaqaaiabdIha4jabcYcaSiabdMha5jabcYcaSiabdogaJnaaDaaaleaacqWGRbWAaeaacqWGZbWCcqWG4baEaaGccqGGSaalcqWGJbWydaqhaaWcbaGaem4AaSgabaGaem4CamNaemyEaKhaaOGaeiilaWIaemOCai3aa0baaSqaaaqaaiabdohaZbaakiabcYcaSiabdMeajnaaDaaaleaaaeaacqWGZbWCaaaakiaawIcacaGLPaaaaSqaaiabdUgaRjabg2da9iabigdaXaqaaiabd6eaobqdcqGHris5aOGaey4kaSYaaabCaeaacqWGNbWzdaqadaqaaiabdIha4jabcYcaSiabdMha5jabcYcaSiabdogaJnaaDaaaleaacqWGRbWAaeaacqWGKbazcqWG4baEaaGccqGGSaalcqWGJbWydaqhaaWcbaGaem4AaSgabaGaemizaqMaemyEaKhaaOGaeiilaWIaemOCai3aa0baaSqaaaqaaiabdsgaKbaakiabcYcaSiabdMeajnaaDaaaleaaaeaacqWGKbazaaaakiaawIcacaGLPaaaaSqaaiabdUgaRjabg2da9iabigdaXaqaaiabd2eanbqdcqGHris5aOGaeiilaWIaaCzcaiaaxMaacqGGOaakcqaI5aqocqGGPaqkaaa@8214@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1471-2105-6-293-i17" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>y</mml:mi><mml:mn>5</mml:mn></mml:mrow><mml:mrow/></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow/><mml:mi>s</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow/><mml:mi>s</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mrow/><mml:mi>d</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mrow/><mml:mi>d</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>,</mml:mo><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGgbGrdaqhaaWcbaGaem4qamKaemyEaKNaeGynaudabaaaaOGaeiikaGIaemiEaGNaeiilaWIaemyEaKNaeiykaKIaeyypa0JaemOuai1aaabCaeaacqWGNbWzdaqadaqaaiabdIha4jabcYcaSiabdMha5jabcYcaSiabdogaJnaaDaaaleaacqWGRbWAaeaacqWGZbWCcqWG4baEaaGccqGGSaalcqWGJbWydaqhaaWcbaGaem4AaSgabaGaem4CamNaemyEaKhaaOGaeiilaWIaemOCai3aa0baaSqaaaqaaiabdohaZbaakiabcYcaSiabdMeajnaaDaaaleaaaeaacqWGZbWCaaaakiaawIcacaGLPaaaaSqaaiabdUgaRjabg2da9iabigdaXaqaaiabd6eaobqdcqGHris5aOGaey4kaSYaaabCaeaacqWGNbWzdaqadaqaaiabdIha4jabcYcaSiabdMha5jabcYcaSiabdogaJnaaDaaaleaacqWGRbWAaeaacqWGKbazcqWG4baEaaGccqGGSaalcqWGJbWydaqhaaWcbaGaem4AaSgabaGaemizaqMaemyEaKhaaOGaeiilaWIaemOCai3aa0baaSqaaaqaaiabdsgaKbaakiabcYcaSiabdMeajnaaDaaaleaaaeaacqWGKbazaaaakiaawIcacaGLPaaaaSqaaiabdUgaRjabg2da9iabigdaXaqaaiabd2eanbqdcqGHris5aOGaeiilaWIaaCzcaiaaxMaacqGGOaakcqaIXaqmcqaIWaamcqGGPaqkaaa@8423@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>where <italic>N </italic>is the number of spots and <italic>M </italic>is the number of dust clusters, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" name="1471-2105-6-293-i18" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGJbWydaqhaaWcbaGaem4AaSgabaGaem4CamNaemiEaGhaaaaa@326F@</mml:annotation></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" name="1471-2105-6-293-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGJbWydaqhaaWcbaGaem4AaSgabaGaem4CamNaemyEaKhaaaaa@3271@</mml:annotation></mml:semantics></mml:math></inline-formula> are the coordinates of the center of a spot, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" name="1471-2105-6-293-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGJbWydaqhaaWcbaGaem4AaSgabaGaemizaqMaemiEaGhaaaaa@3251@</mml:annotation></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" name="1471-2105-6-293-i21" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGJbWydaqhaaWcbaGaem4AaSgabaGaemizaqMaemyEaKhaaaaa@3253@</mml:annotation></mml:semantics></mml:math></inline-formula> are the coordinates of the center of a dust cluster, <italic>r</italic><sup><italic>s </italic></sup>and <italic>r</italic><sup><italic>d </italic></sup>are the approximate radiuses of the spot and dust cluster, respectively, <italic>I</italic><sup><italic>s </italic></sup>and <italic>I</italic><sup><italic>d </italic></sup>are the fluorescence intensity in the center of the spot in the Cy3 color channel and in the center of the dust cluster, respectively, and <italic>R </italic>is the ratio of the test and control samples for each spot. Dust is represented by the random distribution over the array of clusters of pixels of varying brightness. We consider that these pixel clusters have an identical shape to the spots and therefore the same analytical representation is used for an ideal spot shape and dust cluster:</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M29" name="1471-2105-6-293-i22" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow/><mml:mi>x</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow/><mml:mi>y</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mi>exp</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow/><mml:mi>x</mml:mi></mml:msubsup></mml:mrow><mml:mi>r</mml:mi></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow/><mml:mn>4</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>y</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow/><mml:mi>y</mml:mi></mml:msubsup></mml:mrow><mml:mi>r</mml:mi></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow/><mml:mn>4</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow/><mml:mi>x</mml:mi></mml:msubsup></mml:mrow><mml:mi>r</mml:mi></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>y</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow/><mml:mi>y</mml:mi></mml:msubsup></mml:mrow><mml:mi>r</mml:mi></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>11</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGNbWzcqGGOaakcqWG4baEcqGGSaalcqWG5bqEcqGGSaalcqWGJbWydaqhaaWcbaaabaGaemiEaGhaaOGaeiilaWIaem4yam2aa0baaSqaaaqaaiabdMha5baakiabcYcaSiabdkhaYjabcYcaSiabdMeajjabcMcaPiabg2da9iabdMeajjGbcwgaLjabcIha4jabcchaWnaabmaabaGaeyOeI0YaaSGbaeaadaGadaqaamaadmaabaWaaSaaaeaacqWG4baEcqGHsislcqWGJbWydaqhaaWcbaaabaGaemiEaGhaaaGcbaGaemOCaihaaaGaay5waiaaw2faamaaDaaaleaaaeaacqaI0aanaaGccqGHRaWkdaWadaqaamaalaaabaGaemyEaKNaeyOeI0Iaem4yam2aa0baaSqaaaqaaiabdMha5baaaOqaaiabdkhaYbaaaiaawUfacaGLDbaadaqhaaWcbaaabaGaeGinaqdaaOGaey4kaSYaamWaaeaadaWcaaqaaiabdIha4jabgkHiTiabdogaJnaaDaaaleaaaeaacqWG4baEaaaakeaacqWGYbGCaaaacaGLBbGaayzxaaWaa0baaSqaaaqaaiabikdaYaaakmaadmaabaWaaSaaaeaacqWG5bqEcqGHsislcqWGJbWydaqhaaWcbaaabaGaemyEaKhaaaGcbaGaemOCaihaaaGaay5waiaaw2faamaaDaaaleaaaeaacqaIYaGmaaaakiaawUhacaGL9baaaeaacqaIYaGmaaaacaGLOaGaayzkaaGaeiOla4IaaCzcaiaaxMaacqGGOaakcqaIXaqmcqaIXaqmcqGGPaqkaaa@7B17@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>The parameters characterizing the spots (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M30" name="1471-2105-6-293-i18" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGJbWydaqhaaWcbaGaem4AaSgabaGaem4CamNaemiEaGhaaaaa@326F@</mml:annotation></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M31" name="1471-2105-6-293-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGJbWydaqhaaWcbaGaem4AaSgabaGaem4CamNaemyEaKhaaaaa@3271@</mml:annotation></mml:semantics></mml:math></inline-formula>, <italic>r</italic><sup><italic>s</italic></sup>, <italic>I</italic><sup><italic>s </italic></sup>and <italic>R</italic>) are user-defined. For example, the coordinates <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M32" name="1471-2105-6-293-i18" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGJbWydaqhaaWcbaGaem4AaSgabaGaem4CamNaemiEaGhaaaaa@326F@</mml:annotation></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M33" name="1471-2105-6-293-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGJbWydaqhaaWcbaGaem4AaSgabaGaem4CamNaemyEaKhaaaaa@3271@</mml:annotation></mml:semantics></mml:math></inline-formula>, the radius <italic>r</italic><sup><italic>s </italic></sup>and the ranges for <italic>x </italic>and <italic>y </italic>for each spot are defined from a user-defined array design. The user should also specify the number of dust clusters <italic>M </italic>on the array. The other parameters characterizing the dust are random variables, and the probability laws for their generation is a matter of choice. We use uniform distributions for <italic>r</italic><sup><italic>d </italic></sup>(in the interval 0 to <italic>r</italic><sub><italic>m</italic></sub>) and <italic>I</italic><sup><italic>d </italic></sup>(in the interval 0 to <italic>I</italic><sub><italic>m</italic></sub>), where <italic>r</italic><sub><italic>m </italic></sub>and <italic>I</italic><sub><italic>m </italic></sub>are a user-defined maximal dust cluster radius and maximal dust intensity, respectively. We also assume that <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M34" name="1471-2105-6-293-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGJbWydaqhaaWcbaGaem4AaSgabaGaemizaqMaemiEaGhaaaaa@3251@</mml:annotation></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M35" name="1471-2105-6-293-i21" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGJbWydaqhaaWcbaGaem4AaSgabaGaemizaqMaemyEaKhaaaaa@3253@</mml:annotation></mml:semantics></mml:math></inline-formula> are uniformly distributed over the array. Statistical laws of the dust characteristics can generally be different in the two (Cy3, Cy5) channels.</p><p>In the developed simulation model we also account for the nonspecific hybridization and statistical noise:</p><p><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M36" name="1471-2105-6-293-i23" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow/></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mi>i</mml:mi><mml:mrow/></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow/></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>&#x003b7;</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow/></mml:msubsup><mml:msubsup><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow/></mml:msubsup><mml:msub><mml:mi>G</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>&#x003c3;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>12</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGgbGrgaacamaaDaaaleaacqWGPbqAaeaaaaGccqGGOaakcqWG4baEcqGGSaalcqWG5bqEcqGGPaqkcqGH9aqpcqWGgbGrdaqhaaWcbaGaemyAaKgabaaaaOGaeiikaGIaemiEaGNaeiilaWIaemyEaKNaeiykaKIaey4kaSIafmOqaiKbaebadaqhaaWcbaGaemyAaKgabaaaaOGaey4kaSIaeq4TdG2aa0baaSqaaiabdkeacjabdMgaPbqaaaaakiqbdkeaczaaraWaa0baaSqaaiabdMgaPbqaaaaakiabdEeahnaaBaaaleaacqWGcbGqaeqaaOGaey4kaSIaeq4WdmNaeiikaGIaemiEaGNaeiilaWIaemyEaKNaeiykaKIaem4raC0aaSbaaSqaaiabdofatbqabaGccqGGSaalcaWLjaGaaCzcaiabcIcaOiabigdaXiabikdaYiabcMcaPaaa@5C51@</mml:annotation></mml:semantics></mml:math></inline-formula></p><p>where <italic>i </italic>represents either Cy3 or Cy5, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M37" name="1471-2105-6-293-i24" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow/></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGcbGqgaqeamaaDaaaleaacqWGPbqAaeaaaaaaaa@2F59@</mml:annotation></mml:semantics></mml:math></inline-formula> and &#x003b7;<sub><italic>Bi </italic></sub>are the user-defined average and noise-to-signal ratio of nonspecific fluorescence intensity in the color channel <italic>i</italic>, &#x003c3;(<italic>x</italic>,<italic>y</italic>) is the standard deviation of the pixel statistical noise, and <italic>G</italic><sub><italic>B </italic></sub>and <italic>G</italic><sub><italic>S </italic></sub>are independent Gaussian random variables with zero mean and unit standard deviation. The exact representation for &#x003c3;(<italic>x</italic>,<italic>y</italic>) is defined by the experimental set-up. There are currently three possibilities: &#x003c3;(<italic>x</italic>,<italic>y</italic>) can be (i) constant, (ii) proportional to the signal, or (iii) proportional to the square root of signal. The type and quantitative characteristics of the statistical noise are defined by the user.</p></sec></sec><sec><title>Discussion</title><sec><title>Software</title><p>The developed algorithm for quality control is included in the software package MAIA, which offers a complete solution for DNA microarray image analysis, including automatic spot localization and spot quantification procedures. A demo version of the software can be downloaded from [<xref ref-type="bibr" rid="B8">8</xref>].</p></sec><sec><title>Artificial images</title><p>All artificial images were generated using the same array design: 4 &#x000d7; 4 blocks and 21 &#x000d7; 21 spots within each block with the inter-spot distance of 15 pixels. For all spots in the generated arrays the spot radius, <italic>r</italic>, was about 4 pixels, the intensity, <italic>I</italic>, in the Cy3 color channel was 5000 and the ratio, <italic>R</italic>, of the Cy5 and Cy3 channels was 3. Non-specific hybridization was generated using <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M38" name="1471-2105-6-293-i24" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow/></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGcbGqgaqeamaaDaaaleaacqWGPbqAaeaaaaaaaa@2F59@</mml:annotation></mml:semantics></mml:math></inline-formula> = 1000 and &#x003b7;<sub><italic>Bi </italic></sub>= 0.5. The standard deviation of the statistical noise, &#x003c3;(<italic>x</italic>,<italic>y</italic>), at each pixel was proportional to the signal at the corresponding pixel with the noise-to-signal ratio of 0.1. The three generated images (Fig. <xref ref-type="fig" rid="F6">6</xref> (insets)) differed in the number of dust clusters. The percentages of dust clusters with respect to the number of good spots were: 0% (image 6A), 5% (image 6B) and 25% (image 6C). In all cases the maximal dust cluster radius, <italic>r</italic><sub><italic>m</italic></sub>, was set to 8, and maximal dust intensity, <italic>I</italic><sub><italic>m</italic></sub>, to 64000.</p><fig position="float" id="F6"><label>Figure 6</label><caption><p><bold>Quality plots (<italic>Q</italic><sub><italic>k </italic></sub>versus <italic>V</italic><sub><italic>k</italic></sub>) for artificial images. </bold>Three generated images differed in the percentage of dust clusters with respect to the number of good spots: A) 0%, B) 5% and C) 25%. For the further details see the text. The solid lines represent the user-defined ideal quality curves <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>): <italic>Red </italic>&#x02013; exponential (Eq. (6),a); <italic>Blue </italic>&#x02013; Gaussian-like (Eq. (6),b); <italic>Black </italic>&#x02013; inverse (Eq. (6),c).</p></caption><graphic xlink:href="1471-2105-6-293-6"/></fig><p>As all spots have the same theoretical ratio (<italic>R </italic>= 3), they can be considered as replicates and therefore we can use the quantitative characteristics defined in Eqs. (7) and (8) to characterize the performance of the algorithm. We expect the best estimators to provide the averaged Cy5/Cy3 ratio closer to the true ratio (<italic>R </italic>= 3) with the least spread around this value.</p><p>For each artificial array we compared the weighted statistical characteristics for the average <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M39" name="1471-2105-6-293-i25" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGsbGugaqeaaaa@2DF1@</mml:annotation></mml:semantics></mml:math></inline-formula> (Eq. (7)) and for the ratio variation coefficient <italic>V </italic>(Eq. (8)) with the un-weighted ones. The un-weighted characteristics were obtained from Eqs. (7) and (8) by setting all <italic>Q</italic><sub><italic>l</italic></sub>, <italic>l </italic>= 1,...,<italic>n </italic>to 1. The weighted characteristics were calculated with the overall quality values <italic>Q</italic><sub><italic>l </italic></sub>available from the quality analysis algorithm. As all spots from the simulated image can be considered as replicates, we artificially split up the total number of spots into the groups of three closely placed spots. These groups, regarded as independent triplicates, can be used to calculate the experimental quality values <italic>Q</italic><sub><italic>k </italic></sub>(Eq. (4)) and to build up the corresponding quality plot (<italic>Q</italic><sub><italic>k </italic></sub><italic>versus V</italic><sub><italic>k</italic></sub>). Three functional shapes (Eq. (6)) for the ideal quality curve <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>) were tested.</p><p>The results are collected in Table <xref ref-type="table" rid="T1">1</xref>. The weighted statistical characteristics with the developed quality control eliminated bias in the average Cy5/Cy3 ratio estimates and reduced the ratio variation coefficient. Note that for "ideal" image 6A (no dust clusters) the applied quality measures retained the estimates unchanged.</p><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>The average <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M40" name="1471-2105-6-293-i25" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGsbGugaqeaaaa@2DF1@</mml:annotation></mml:semantics></mml:math></inline-formula> (Eq. (7)) and the coefficient of variation <italic>V </italic>(Eq. (8)) of the Cy5/Cy3 ratios over all spots for three artificial images A, B, and C from Fig 6</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">Image</td><td align="center" colspan="2">A</td><td align="center" colspan="2">B</td><td align="center" colspan="2">C</td></tr></thead><tbody><tr><td></td><td align="center"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M41" name="1471-2105-6-293-i25" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGsbGugaqeaaaa@2DF1@</mml:annotation></mml:semantics></mml:math></inline-formula></td><td align="center"><italic>V</italic></td><td align="center"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M42" name="1471-2105-6-293-i25" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGsbGugaqeaaaa@2DF1@</mml:annotation></mml:semantics></mml:math></inline-formula></td><td align="center"><italic>V</italic></td><td align="center"><inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M43" name="1471-2105-6-293-i25" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGsbGugaqeaaaa@2DF1@</mml:annotation></mml:semantics></mml:math></inline-formula></td><td align="center"><italic>V</italic></td></tr><tr><td colspan="7"><hr></hr></td></tr><tr><td align="center">No quality control</td><td align="center">3.00</td><td align="center">0.028</td><td align="center">2.96</td><td align="center">0.20</td><td align="center">2.84</td><td align="center">0.35</td></tr><tr><td align="center"><italic>f</italic>(<italic>V</italic><sub><italic>k </italic></sub>) =exp{-<italic>V</italic><sub><italic>k</italic></sub>/<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M44" name="1471-2105-6-293-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGwbGvgaqeaaaa@2DF9@</mml:annotation></mml:semantics></mml:math></inline-formula>}</td><td align="center">3.00</td><td align="center">0.028</td><td align="center">2.99</td><td align="center">0.041</td><td align="center">2.99</td><td align="center">0.089</td></tr><tr><td align="center"><italic>f</italic>(<italic>V</italic><sub><italic>k </italic></sub>) =exp{-<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M45" name="1471-2105-6-293-i26" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGwbGvdaqhaaWcbaGaem4AaSgabaGaeGOmaidaaaaa@305F@</mml:annotation></mml:semantics></mml:math></inline-formula>/<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M46" name="1471-2105-6-293-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGwbGvgaqeaaaa@2DF9@</mml:annotation></mml:semantics></mml:math></inline-formula><sup>2</sup>}</td><td align="center">3.00</td><td align="center">0.028</td><td align="center">2.99</td><td align="center">0.038</td><td align="center">2.99</td><td align="center">0.097</td></tr><tr><td align="center"><italic>f</italic>(<italic>V</italic><sub><italic>k </italic></sub>) =1/{1 + 
									<italic>V</italic><sub><italic>k</italic></sub>/<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M47" name="1471-2105-6-293-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGwbGvgaqeaaaa@2DF9@</mml:annotation></mml:semantics></mml:math></inline-formula>}</td><td align="center">3.00</td><td align="center">0.028</td><td align="center">2.99</td><td align="center">0.042</td><td align="center">2.99</td><td align="center">0.094</td></tr></tbody></table></table-wrap><p>The three compared ideal quality shapes <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>) (Eq. (6)) demonstrated similar performance. A small advantage (slightly smaller <italic>V</italic>) of the Gaussian-like function (Eq. (6),b) for image 6B (5% of dust clusters) was compensated by the lowest performance for image 6C (25% of dust clusters). The difference between the three shapes can be seen from Fig <xref ref-type="fig" rid="F6">6</xref>, where the corresponding quality plots are drawn for the three generated images. The inverse shape (Eq. (6),c) is the least stringent whereas the Gaussian-like shape is the most stringent with respect to the replicates variability. This means that the inverse shape does not require the replicates with higher variability to have lower quality values (and correspondingly the replicates with smaller variability to have higher quality values) as strictly as the Gaussian-like one. Although it seems that the Gaussian-like shape is the best choice, there is still a drawback. Due to its relatively abrupt decrease it is difficult to keep the balance in fitting weights &#x003c8;<sub><italic>k </italic></sub>between the head and the tail of the shape. Despite the adaptive selection of the fitting weights &#x003c8;<sub><italic>k </italic></sub>(see section Spot quality analysis), the fitting procedure, trying to ensure the highest quality for the replicates with the lowest variability, may still overlook the replicates with the higher variability. This depends on the image quality (replicate variability) and can explain why the Gaussian-like shape yielded the greatest ratio variation for image 6C. This also indicates that more work is needed to find out an optimal combination of the ideal quality curve and the fitting weights &#x003c8;<sub><italic>k </italic></sub>to be used in the training procedure.</p><p>The results of simulation study and our experience with the experimental images suggest that the exponential shape (Eq. (6),a) offers a reasonable compromise between the fitting weights used and stringency with respect to the replicates variability. Therefore in the further quality analysis we will apply exponential <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>).</p></sec><sec><title>Experimental images</title><p>We performed quality analysis of two experimental images with different array designs and signal-to-noise levels.</p><p>One image (Fig. <xref ref-type="fig" rid="F7">7A</xref>) (image 7A) was provided as a demonstration example for UCSF Spot 2.0 (downloadable from [<xref ref-type="bibr" rid="B16">16</xref>]). It contains 4 &#x000d7; 4 blocks with 21 &#x000d7; 21 spots in each block, with a spot cell size of about 10 pixels. Cy3 and Cy5 color channels are strongly correlated, with the average correlation coefficient for the spots being about 0.97. Bright contamination spots can be seen irregularly scattered over the array. The magnified image of one such spot is shown in Fig. <xref ref-type="fig" rid="F2">2</xref> (inset). Each clone was spotted in triplicate. The replicated spots are placed as neighbors in a row (see Fig. <xref ref-type="fig" rid="F7">7A</xref>).</p><fig position="float" id="F7"><label>Figure 7</label><caption><p><bold>Experimental images. </bold>A) 4 &#x000d7; 4 blocks with 21 &#x000d7; 21 spots per block, spot cell size is about 10 pixels; B) 12 &#x000d7; 4 blocks with 15 &#x000d7; 15 spots per block, spot cell size is about 30 pixels. The locations of triplicates are indicated.</p></caption><graphic xlink:href="1471-2105-6-293-7"/></fig><p>The second image (from the Institute Curie) (image 7B) contains 12 &#x000d7; 4 blocks with 12 &#x000d7; 12 spots in each block (Fig. <xref ref-type="fig" rid="F7">7B</xref>), with a spot cell size of about 30 pixels. The average correlation between the channels for the spots is about 0.85. This is lower than for the first image, although this image has no obvious contamination spots. Each clone was prepared in triplicate, with the replicated spots in three vertically distributed sub-arrays (see Fig. <xref ref-type="fig" rid="F7">7B</xref>).</p><p>We expect the Cy5/Cy3 ratios from the replicates to be similar. Therefore it is reasonable to take the coefficient of variation (Eq. (8)) of the replicates as a quantitative measure of the ratio estimation consistency. However, this measure may not be totally objective: (i) the estimates may be consistent, but systematically biased (the true values of the ratios are unknown); (ii) three replicated spots of very poor quality may give very similar ratio values just by chance (the number of replicates is low).</p><p>The average over all replicates at the given array coefficient of variation is taken as a global indicator of the Cy5/Cy3 ratio consistency of the array.</p><p>We compared two quality characteristics (the coefficient of determination <italic>CD </italic>(<italic>q</italic><sub><italic>1</italic></sub>) and the coefficient of variation of two ratio estimates <italic>CVR </italic>(<italic>q</italic><sub><italic>7</italic></sub>), applied separately) and the overall quality parameter <italic>Q </italic>(Eq. (1)) to the case when no quality control was applied. The weights of the marginal quality parameters for <italic>Q </italic>were identified using the exponential ideal quality curve (Eq. (6),a) with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M48" name="1471-2105-6-293-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGwbGvgaqeaaaa@2DF9@</mml:annotation></mml:semantics></mml:math></inline-formula> &#x02248; 0.08 for image 7A, and with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M49" name="1471-2105-6-293-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGwbGvgaqeaaaa@2DF9@</mml:annotation></mml:semantics></mml:math></inline-formula> &#x02248; 0.2 for image 7B. The results are summarized in Table <xref ref-type="table" rid="T2">2</xref>.</p><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>The average over all replicates coefficients of variation <italic>V </italic>(Eq. (8)) for two experimental images A and B from Fig. 7</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">Quality Control</td><td align="center">A</td><td align="center">B</td></tr></thead><tbody><tr><td align="center">No control</td><td align="center">0.066</td><td align="center">0.120</td></tr><tr><td align="center"><italic>CD</italic></td><td align="center">0.019</td><td align="center">0.105</td></tr><tr><td align="center"><italic>CVR</italic></td><td align="center">0.028</td><td align="center">0.102</td></tr><tr><td align="center">Overall <italic>Q</italic></td><td align="center">0.017</td><td align="center">0.101</td></tr></tbody></table></table-wrap><p>We found a greater improvement for image 7A than for image 7B after applying the quality measures. This was not a surprise, as image 7B is characterized by a reasonably high signal-to-noise level, and it does not contain any obvious contaminated spots. However, even in this case the quality measures cannot be ignored, as there are still a few low-intensity spots that need to be specially treated (probably rejected). By contrast, image 7A has obvious randomly distributed pieces of dust, and the developed quality measures proved to be powerful enough to disregard the contaminated spots, thus increasing the consistency of the Cy5/Cy3 ratio estimates.</p><p>The comparison of the different quality measures has shown that they are array-specific. For image 7B, <italic>CD</italic>, <italic>CVR </italic>and <italic>Q </italic>gave almost equivalent performance, whereas for image 7A, <italic>CD </italic>was much better than <italic>CVR</italic>, and <italic>Q </italic>gave a slightly better ratio consistency than both of these. However, the gain from <italic>Q </italic>was not much greater, so that it would be reasonable to assume that only a single quality measure (such as <italic>CD </italic>or <italic>CVR</italic>) could always give good results. Unfortunately, this is not the case. Although we have found that <italic>CD </italic>and <italic>CVR </italic>are indeed the most powerful quality measures they cannot cover every type of distortion.</p><p>We demonstrate this with image 7A. There remained, after applying the individual quality measures, several triplicates with high coefficients of variation that were not correctly suppressed. Three such replicates are shown in Fig. <xref ref-type="fig" rid="F5">5</xref>, and the main quantitative characteristics of the corresponding spots are listed in Table <xref ref-type="table" rid="T3">3</xref>. Note that Table <xref ref-type="table" rid="T3">3</xref> contains the quality characteristics from section Quality characteristics, which do not need to reside in the interval [0;1].</p><table-wrap position="float" id="T3"><label>Table 3</label><caption><p>The main characteristics of the spots from three triplicates (see Fig. 5 (insets)), demonstrating excessive variability in the Cy5/Cy3 ratio estimates</p></caption><table frame="hsides" rules="groups"><thead><tr><td align="center">Triplicate</td><td align="center">Quality Parameter</td><td align="center">Spot 1</td><td align="center">Spot 2</td><td align="center">Spot 3</td></tr></thead><tbody><tr><td align="center">A</td><td align="center">Ratio</td><td align="center">0.27</td><td align="center">0.26</td><td align="center">0.12</td></tr><tr><td></td><td align="center"><italic>CD</italic></td><td align="center">0.98</td><td align="center">0.98</td><td align="center">0.97</td></tr><tr><td></td><td align="center"><italic>CVR</italic></td><td align="center">0.016</td><td align="center">0.014</td><td align="center">0.11</td></tr><tr><td></td><td align="center"><italic>IS</italic></td><td align="center">0.17</td><td align="center">0.21</td><td align="center">1.02</td></tr><tr><td></td><td align="center"><italic>UB</italic></td><td align="center">0.060</td><td align="center">0.10</td><td align="center">0.31</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">B</td><td align="center">Ratio</td><td align="center">0.19</td><td align="center">0.13</td><td align="center">0.072</td></tr><tr><td></td><td align="center"><italic>CD</italic></td><td align="center">0.85</td><td align="center">0.60</td><td align="center">0.33</td></tr><tr><td></td><td align="center"><italic>CVR</italic></td><td align="center">0.010</td><td align="center">0.014</td><td align="center">0.012</td></tr><tr><td></td><td align="center"><italic>IS</italic></td><td align="center">0.15</td><td align="center">0.072</td><td align="center">0.041</td></tr><tr><td></td><td align="center"><italic>UB</italic></td><td align="center">0.041</td><td align="center">0.030</td><td align="center">0.042</td></tr><tr><td colspan="5"><hr></hr></td></tr><tr><td align="center">C</td><td align="center">Ratio</td><td align="center">0.29</td><td align="center">0.30</td><td align="center">0.44</td></tr><tr><td></td><td align="center"><italic>CD</italic></td><td align="center">0.97</td><td align="center">0.97</td><td align="center">0.93</td></tr><tr><td></td><td align="center"><italic>CVR</italic></td><td align="center">0.010</td><td align="center">0.011</td><td align="center">0.0052</td></tr><tr><td></td><td align="center"><italic>IS</italic></td><td align="center">0.12</td><td align="center">0.15</td><td align="center">0.36</td></tr><tr><td></td><td align="center"><italic>UB</italic></td><td align="center">0.24</td><td align="center">0.11</td><td align="center">0.99</td></tr></tbody></table></table-wrap><p>In triplicate A, one spot is clearly contaminated; however, this contamination is highly correlated in the two channels (<italic>CD </italic>= 0.97) and the spots cannot be filtered out using <italic>CD</italic>. A more powerful parameter for this type of problem is <italic>CVR </italic>(0.11), perhaps in combination with <italic>IS </italic>(1.02). Triplicate B includes low-intensity spots. Although <italic>CVR </italic>quality characteristic does not detect any deficiency in this case, the difference between the estimated intensity ratios (within the triplicate) is large, meaning that <italic>CVR </italic>alone is not sufficient to eliminate the outlier spots. <italic>CD </italic>seems to be more indicative in this case. Triplicate C cannot be confidently recognized either by <italic>CD </italic>or <italic>CVR </italic>quality measures. This problem (contamination penetrating into the spot from the outside area) can be figured out by applying either the uniformity of the background quality parameter (<italic>UB </italic>= 0.99) or the Durbin-Watson quality parameter (<italic>DWS </italic>= 0.58).</p><p>This type of analysis leads to the refined critical values <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M50" name="1471-2105-6-293-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>lim</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG4baEdaqhaaWcbaGaemyAaKgajeaybaGagiiBaWMaeiyAaKMaeiyBa0gaaaaa@3435@</mml:annotation></mml:semantics></mml:math></inline-formula> for each of the quality characteristics. These <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M51" name="1471-2105-6-293-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>lim</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG4baEdaqhaaWcbaGaemyAaKgajeaybaGagiiBaWMaeiyAaKMaeiyBa0gaaaaa@3435@</mml:annotation></mml:semantics></mml:math></inline-formula> values are then recalculated into the corresponding weights <italic>w</italic><sub><italic>i </italic></sub>for the user-selected overall quality threshold <italic>Q</italic><sup>lim</sup>, using Eq. (2) (see Fig. <xref ref-type="fig" rid="F4">4</xref>). In general, however, the weights are derived automatically from Eq. (5) by the non-linear fitting procedure. If certain quality factors do not influence the shape of the experimental quality curve <italic>Q</italic><sub><italic>E </italic></sub>(Eq. (4)), the corresponding weights will be set close to 0. If a certain effect shows up in only a small number of spots, it may be neglected by the optimization procedure, and the corresponding weight will be erroneously small. In this case, manual correction of the weights would be necessary.</p><p>The quality value of three bad replicates from Fig. <xref ref-type="fig" rid="F5">5</xref> (insets), as well as of many others demonstrating larger deviations in the obtained Cy5/Cy3 ratio estimates (Fig. <xref ref-type="fig" rid="F5">5</xref>), were decreased using the combined criteria <italic>Q</italic>, whereas the quality of replicates with smaller variations remained almost unaffected.</p><p>Quality measures can signal some of the replicates to be bad despite there being no big difference in the ratios. With a small number of replicated spots all spots from a replicate may indeed have very close ratios, but several of them may be really deficient. Therefore, it is more important to consider those replicates demonstrating unusually high diversity in the obtained ratio estimates. This clearly suggests problems in the spots. Algorithmically, this can be achieved by assigning larger weights &#x003c8;<sub><italic>k </italic></sub>to these replicates in the non-linear fitting procedure (Eq. (5)). The fitted parameters <italic>w</italic><sub><italic>i </italic></sub>are then used to flag out all deficient spots, even those that belong to the replicates with the consistent ratio estimates. However, if <italic>all </italic>spots from a consistent replicate demonstrate poor quality, this can also be an indication that this replicate is actually good, but it was erroneously flagged out by the quality analysis procedure. This would require user intervention to correct for the selected set of quality characteristics and/or for the corresponding quality weight <italic>w</italic><sub><italic>i</italic></sub>. Additional procedures for automatic analysis of the replicates with consistent ratios but low quality values can be envisaged.</p><p>The fact that overall <italic>Q </italic>does not show up much better performance (Table <xref ref-type="table" rid="T2">2</xref>) is due to rather good general quality of the images, and a few problematic triplicates cannot influence very much the averaged coefficients of variation. For example, in image 7A, we have less than 9% of triplicates with the ratio variation coefficients larger that the selected <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M52" name="1471-2105-6-293-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGwbGvgaqeaaaa@2DF9@</mml:annotation></mml:semantics></mml:math></inline-formula> (~0.08), and 7% for image 7B (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M53" name="1471-2105-6-293-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGwbGvgaqeaaaa@2DF9@</mml:annotation></mml:semantics></mml:math></inline-formula> &#x02248; 0.2).</p></sec><sec><title>Replicated arrays</title><p>Quality analysis can also be performed with replicated spots from different arrays. Three replicated images (Fig. <xref ref-type="fig" rid="F8">8</xref> (insets)) were used for quality analysis. Although each image contains three replicated spots placed as neighbors in a row (similar to image A from Fig. <xref ref-type="fig" rid="F7">7</xref>), we pretended that there were no replicates within each array. Therefore we made available only replicated spots from different arrays for quality analysis. In Fig. <xref ref-type="fig" rid="F8">8</xref> we present three quality plots. Black dots correspond to the case when the three replicated images were combined without normalization and the default quality weights were used. Relatively large coefficients of variation are due to the bias in the obtained Cy5/Cy3 ratio estimates between the three images. To apply our algorithm of quality analysis in this case the ideal quality curve should account for this bias, i.e. it should implicitly incorporate image normalization model. A simpler way would be to separate the normalization and quality analysis procedures: the image normalization should precede the quality analysis, or we can also envisage an iterative procedure where the steps of normalization and quality analysis are performed in turn. Taking into account that a variety of normalization methods [<xref ref-type="bibr" rid="B17">17</xref>] are currently available, we leave the detailed development of the quality analysis strategy in this case for the future.</p><fig position="float" id="F8"><label>Figure 8</label><caption><p><bold>Quality plots (<italic>Q</italic><sub><italic>k </italic></sub>versus <italic>V</italic><sub><italic>k</italic></sub>) using replicated arrays. </bold><italic>Black dots </italic>&#x02013; three replicated images (insets) are combined without normalization and the default quality weights are used; <italic>red dots </italic>&#x02013; three replicated images (insets) are combined after the global normalization; <italic>blue dots </italic>&#x02013; triplicate spots from the first array are used. The solid lines represent the exponential ideal quality curves <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>) (Eq. (6),a): <italic>Red line </italic>(for the red dots) &#x02013; <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M54" name="1471-2105-6-293-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGwbGvgaqeaaaa@2DF9@</mml:annotation></mml:semantics></mml:math></inline-formula> &#x02248; 0.125; Blue line (for the blue dots) &#x02013; <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M55" name="1471-2105-6-293-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGwbGvgaqeaaaa@2DF9@</mml:annotation></mml:semantics></mml:math></inline-formula> &#x02248; 0.08.</p></caption><graphic xlink:href="1471-2105-6-293-8"/></fig><p>As an example, we applied a global normalization algorithm [<xref ref-type="bibr" rid="B18">18</xref>]. It is assumed that most genes are not differentially expressed and therefore the expected averaged over all spots of the array Cy5/Cy3 ratio should be close to one. The normalization constant <italic>a </italic>for each array can be calculated as <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M56" name="1471-2105-6-293-i27" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>&#x02061;</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mi>ln</mml:mi><mml:mo>&#x02061;</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGHbqycqGH9aqpcyGGLbqzcqGG4baEcqGGWbaCdaGadaqaamaalyaabaWaaabCaeaacyGGSbaBcqGGUbGBcqWGsbGudaWgaaWcbaGaemyAaKgabeaaaeaacqWGPbqAcqGH9aqpcqaIXaqmaeaacqWGUbGBa0GaeyyeIuoaaOqaaiabd6gaUbaaaiaawUhacaGL9baaaaa@434E@</mml:annotation></mml:semantics></mml:math></inline-formula>, where <italic>n </italic>is the number of spots and <italic>R</italic><sub><italic>i </italic></sub>is the ratio estimate for the <italic>i</italic>-th spot. Red dots in Fig <xref ref-type="fig" rid="F8">8</xref> represent the quality curve using the replicated arrays after the global normalization. For comparison, blue dots show the quality curve using the triplicates from the first array. The red-dot cloud spreads wider, because, even after normalization, the variability of replicates from different arrays is higher than from the same array (where replicates were closely placed). Despite this replicated arrays can be used in the quality analysis since the required tendency &#x02013; the decrease of the overall quality with the increase of the replicate variability &#x02013; can be ensured. To account for higher levels of inter-array statistical variability in replicates, we have to apply less stringent ideal quality curve. This can be achieved by selecting larger values for the parameter <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M57" name="1471-2105-6-293-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGwbGvgaqeaaaa@2DF9@</mml:annotation></mml:semantics></mml:math></inline-formula> in Eq. (6).</p></sec><sec><title>Quality weight extrapolation</title><p>We demonstrate here a possibility to apply quality weights obtained from the analysis of one training image, which should contain replicated spots, to other arrays, which may not contain replicates. We used two images (Figs. <xref ref-type="fig" rid="F9">9A</xref> and <xref ref-type="fig" rid="F9">9B</xref>) of the same design as before: each image contains three replicated spots placed as neighbors in a row. Image 9A has obvious deficiencies (large amount of absent spots, scratches, contamination), whereas image 9B is less problematic.</p><fig position="float" id="F9"><label>Figure 9</label><caption><p><bold>Quality analysis of poor-quality (A) and good-quality (B) images. </bold>A: (a) Poor-quality image; (b) Image A with the "bad" spots identified by the quality analysis based on its own triplicates. B: (a) Image B with the bad spots identified by the quality analysis based on the triplicates from image A; (b) Image B with the bad spots identified by the quality analysis based on its own triplicates. "Bad" spots are the spots with the overall quality below 0.3. "Bad" spots are indicated by the white crosses.</p></caption><graphic xlink:href="1471-2105-6-293-9"/></fig><p>The quality weights were estimated from the triplicates of image 9A, as it contains a wider diversity of possible artifacts and distortions. Using the obtained weights the "bad" spots were identified in image 9A. A spot was classified as a bad spot if its overall quality was below 0.3. Fig. <xref ref-type="fig" rid="F9">9A(b)</xref> shows the same image with the "bad" spots indicated by the white crosses.</p><p>To eliminate the "bad" spots (<italic>Q </italic>&#x0003c; 0.3) from image 9B, we first applied the quality weights obtained for image 9A. The result is shown in Fig. <xref ref-type="fig" rid="F9">9B(a)</xref>. Then we performed quality analysis for image 9B using its own triplicates. The spots flagged out by this approach are indicated in Fig. <xref ref-type="fig" rid="F9">9B(b)</xref>. Comparing Figs. <xref ref-type="fig" rid="F9">9B(a)</xref> and <xref ref-type="fig" rid="F9">9B(b)</xref>, one can conclude that the results are very similar, although not identical, of course.</p><p>This example attempts to reproduce an important possibility of designing microarray experiments. A small number of training arrays with replicated spots and representative diversity of possible artifacts can be measured and analyzed. The obtained results can then be used to evaluate the quality of other arrays of similar design, which may not contain replicated spots.</p></sec></sec><sec><title>Conclusion</title><p>We have described an algorithm for quantitative spot quality evaluation in DNA microarray image analysis that allows the automatic identification of the weights for the marginal quality parameters within the model combining these parameters into an overall spot quality value. The algorithm relies on the assumption that unspoiled replicated spots should have higher levels of consistency in the obtained Cy5/Cy3 ratio estimates than "bad" spots. The user is only required to define an ideal quality curve <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>) establishing how fast the overall quality of the replicates must decrease with increasing ratio variation in the corresponding replicates. For simple models from Eq. (6) only one parameter &#x02013; the characteristic ratio variation coefficient <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M58" name="1471-2105-6-293-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGwbGvgaqeaaaa@2DF9@</mml:annotation></mml:semantics></mml:math></inline-formula> &#x02013; must be specified. In this paper the functional shape for <italic>f</italic>(<italic>V</italic><sub><italic>k</italic></sub>) was empirically selected through numerous experiments with artificial and experimental images. This, however, may not be an optimal choice and further improvements can be expected, preferably using more theoretical approaches. A complementary perspective is to further elaborate the algorithm for estimating the fitting weights &#x003c8;<sub><italic>k</italic></sub>, which may be implicitly dependent on the ideal quality curve.</p><p>We use nine marginal quality characteristics, which cover a broad range of different deviations from a normal (good) spot. Therefore, it is possible that some of these parameters will not be relevant for a certain image. For example, if there are no clearly un-circular spots, the corresponding parameter (<italic>GS</italic>) can be omitted. The optimization procedure will however report this, assigning a very low weight to the corresponding quality characteristic. These weights are then converted into the critical levels <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M59" name="1471-2105-6-293-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>lim</mml:mi><mml:mo>&#x02061;</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG4baEdaqhaaWcbaGaemyAaKgajeaybaGagiiBaWMaeiyAaKMaeiyBa0gaaaaa@3435@</mml:annotation></mml:semantics></mml:math></inline-formula> using Eq. (2), which will tolerate a big diversity in the possible values of the corresponding parameter. Thus, the developed procedure both searches for the weights and implicitly reports on the relevance of the quality parameters to each particular image. However, if the images used to train the model (that is to identify the weights) are not representative enough and do not contain enough spots with certain types of artifacts, some important sources of spot deficiency may be overlooked. In this case, manual adjustment of the weights may be necessary.</p><p>Another problem is that generally a very small number of replicated spots (rarely more than 3) are available for the analysis. Therefore it is possible that all spots from a replicate, being defective, demonstrate consistent Cy5/Cy3 ratio values. However, we expect that is less probable than to observe unusually high diversity in the ratio estimates for these replicates. If all spots from a consistent replicate are actually good, but they are erroneously assigned low quality values, this is an indication of some problems in the quality analysis itself. This situation would possibly require user participation to correct for the selected set of quality characteristics and/or for the corresponding quality weights <italic>w</italic><sub><italic>i</italic></sub>.</p><p>We have demonstrated a possibility to carry out the quality analysis using replicated spots from different arrays. An additional procedure of the image normalization should precede the quality analysis in this case.</p></sec><sec><title>Authors' contributions</title><p>EN conceived the algorithm, performed software implementation and drafted the manuscript. EB conceived of the study and participated in coordination. All authors read and approved the final manuscript.</p></sec></body><back><ack><sec><title>Acknowledgements</title><p>We would like to thank our colleagues from the different laboratories of the Institute Curie: (F. Radvanyi, UMR 144 CNRS/IC: Compartimentation et dynamique cellulaires; O. Delattre, INSERM 509: Pathologie mol&#x000e9;culaire des cancers; M. Dutreix, UMR 2027 CNRS/IC: G&#x000e9;notoxicologie et cycle cellulaire) and Prof. D. Pinkel (UCSF Comprehensive Cancer Center) who have provided numerous microarray images allowing considerable improvement of the algorithms.</p></sec></ack><ref-list><ref id="B1"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hegde</surname><given-names>P</given-names></name><name><surname>Qi</surname><given-names>R</given-names></name><name><surname>Abernathy</surname><given-names>K</given-names></name><name><surname>Gay</surname><given-names>C</given-names></name><name><surname>Dharap</surname><given-names>S</given-names></name><name><surname>Gaspard</surname><given-names>R</given-names></name><name><surname>Hughes</surname><given-names>JE</given-names></name><name><surname>Snesrud</surname><given-names>E</given-names></name><name><surname>Lee</surname><given-names>N</given-names></name><name><surname>Quackenbush</surname><given-names>J</given-names></name></person-group><article-title>A concise guide to cDNA microarray analysis</article-title><source>Biotechniques</source><year>2000</year><volume>29</volume><fpage>548</fpage><lpage>562</lpage><pub-id pub-id-type="pmid">10997270</pub-id></citation></ref><ref id="B2"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Pinkel</surname><given-names>D</given-names></name><name><surname>Segraves</surname><given-names>R</given-names></name><name><surname>Sudar</surname><given-names>D</given-names></name><name><surname>Clark</surname><given-names>S</given-names></name><name><surname>Poole</surname><given-names>I</given-names></name><name><surname>Kowbel</surname><given-names>D</given-names></name><name><surname>Collins</surname><given-names>C</given-names></name><name><surname>Kuo</surname><given-names>WL</given-names></name><name><surname>Chen</surname><given-names>C</given-names></name><name><surname>Zhai</surname><given-names>Y</given-names></name><name><surname>Dairkee</surname><given-names>SH</given-names></name><name><surname>Ljung</surname><given-names>BM</given-names></name><name><surname>Gray</surname><given-names>JW</given-names></name><name><surname>Albertson</surname><given-names>DG</given-names></name></person-group><article-title>High resolution analysis of DNA copy number variation using comparative genomic hybridization to microarrays</article-title><source>Nature Genetics</source><year>1998</year><volume>20</volume><fpage>207</fpage><lpage>211</lpage><pub-id pub-id-type="pmid">9771718</pub-id><pub-id pub-id-type="doi">10.1038/2524</pub-id></citation></ref><ref id="B3"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Buhler</surname><given-names>J</given-names></name><name><surname>Ideker</surname><given-names>T</given-names></name><name><surname>Haynor</surname><given-names>D</given-names></name></person-group><article-title>Dapple: improved techniques for finding spots on DNA microarrays</article-title><source>UW CSE Technical Report UWTP 2000-08-05</source><year>2000</year></citation></ref><ref id="B4"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>CS</given-names></name><name><surname>Goodwin</surname><given-names>PC</given-names></name><name><surname>Sorger</surname><given-names>PK</given-names></name></person-group><article-title>Image metrics in the statistical analysis of DNA microarray data</article-title><source>PNAS</source><year>2001</year><volume>98</volume><fpage>8944</fpage><lpage>8949</lpage><pub-id pub-id-type="pmid">11481466</pub-id><pub-id pub-id-type="doi">10.1073/pnas.161242998</pub-id></citation></ref><ref id="B5"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>X</given-names></name><name><surname>Ghosh</surname><given-names>S</given-names></name><name><surname>Guo</surname><given-names>SW</given-names></name></person-group><article-title>Quantitative quality control in microarray image processing and data acquisition</article-title><source>Nucleic Acids Res</source><year>2001</year><volume>29</volume><fpage>e75</fpage><pub-id pub-id-type="pmid">11470890</pub-id><pub-id pub-id-type="doi">10.1093/nar/29.15.e75</pub-id></citation></ref><ref id="B6"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>Y</given-names></name><name><surname>Kamat</surname><given-names>V</given-names></name><name><surname>Dougherty</surname><given-names>ER</given-names></name><name><surname>Bittner</surname><given-names>ML</given-names></name><name><surname>Meltzer</surname><given-names>PS</given-names></name><name><surname>Trent</surname><given-names>JM</given-names></name></person-group><article-title>Ratio statistics of gene expression levels and applications to microarray data analysis</article-title><source>Bioinformatics</source><year>2002</year><volume>18</volume><fpage>1207</fpage><lpage>1215</lpage><pub-id pub-id-type="pmid">12217912</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/18.9.1207</pub-id></citation></ref><ref id="B7"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Hautaniemi</surname><given-names>S</given-names></name><name><surname>Edgren</surname><given-names>H</given-names></name><name><surname>Vesanen</surname><given-names>P</given-names></name><name><surname>Wolf</surname><given-names>M</given-names></name><name><surname>J&#x000e4;rvinen</surname><given-names>AK</given-names></name><name><surname>Yli-Harja</surname><given-names>O</given-names></name><name><surname>Astola</surname><given-names>J</given-names></name><name><surname>Kallioniemi</surname><given-names>O</given-names></name><name><surname>Monni</surname><given-names>O</given-names></name></person-group><article-title>A novel strategy for microarray quality control using Bayesian networks</article-title><source>Bioinformatics</source><year>2003</year><volume>19</volume><fpage>2031</fpage><lpage>2038</lpage><pub-id pub-id-type="pmid">14594707</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/btg275</pub-id></citation></ref><ref id="B8"><citation citation-type="other"><article-title>Software package for automatic microarray image analysis (MAIA)</article-title><ext-link ext-link-type="uri" xlink:href="http://bioinfo.curie.fr/projects/maia"/></citation></ref><ref id="B9"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Novikov</surname><given-names>E</given-names></name><name><surname>Barillot</surname><given-names>E</given-names></name></person-group><article-title>A robust algorithm for ratio estimation in two-color microarray experiments</article-title><source>Journal of Bioinformatics and Computational Biology</source><year>2005</year><volume>3</volume><fpage>1411</fpage><lpage>1428</lpage><pub-id pub-id-type="pmid">16374914</pub-id><pub-id pub-id-type="doi">10.1142/S0219720005001624</pub-id></citation></ref><ref id="B10"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Bozinov</surname><given-names>D</given-names></name><name><surname>Rahnenf&#x000fc;hrer</surname><given-names>J</given-names></name></person-group><article-title>Unsupervised technique for robust target separation and analysis of DNA microarray spots through adaptive pixel clustering</article-title><source>Bioinformatics</source><year>2002</year><volume>18</volume><fpage>747</fpage><lpage>756</lpage><pub-id pub-id-type="pmid">12050071</pub-id><pub-id pub-id-type="doi">10.1093/bioinformatics/18.5.747</pub-id></citation></ref><ref id="B11"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Kendall</surname><given-names>MG</given-names></name><name><surname>Stuart</surname><given-names>A</given-names></name></person-group><source>The Advanced Theory Of Statistics</source><year>1979</year><volume>2</volume><publisher-name>McMillan: New York</publisher-name></citation></ref><ref id="B12"><citation citation-type="other"><person-group person-group-type="author"><name><surname>Dissanaike</surname><given-names>G</given-names></name><name><surname>Wang</surname><given-names>S</given-names></name></person-group><article-title>A critical examination of orthogonal regression</article-title><year>2003</year><ext-link ext-link-type="uri" xlink:href="http://ssrn.com/abstract=407560"/></citation></ref><ref id="B13"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>LD</given-names></name><name><surname>van Belle</surname><given-names>G</given-names></name></person-group><source>Biostatistics A Methodology for the Heath Sciences</source><year>1993</year><publisher-name>John Willey &#x00026; Sons: New York</publisher-name></citation></ref><ref id="B14"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Draper</surname><given-names>NR</given-names></name><name><surname>Smith</surname><given-names>H</given-names></name></person-group><source>Applied regression analysis</source><year>1998</year><publisher-name>John Wiley &#x00026; Sons: New York</publisher-name></citation></ref><ref id="B15"><citation citation-type="book"><person-group person-group-type="author"><name><surname>Bevington</surname><given-names>PR</given-names></name><name><surname>Robinson</surname><given-names>DK</given-names></name></person-group><source>Data reduction and error analysis for the physical sciences</source><year>1991</year><publisher-name>McGraw-Hill: New York</publisher-name></citation></ref><ref id="B16"><citation citation-type="other"><article-title>Jain Lab Downloads</article-title><ext-link ext-link-type="uri" xlink:href="http://jainlab.ucsf.edu/Downloads.html"/></citation></ref><ref id="B17"><citation citation-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>W</given-names></name><name><surname>Xing</surname><given-names>EP</given-names></name><name><surname>Myers</surname><given-names>C</given-names></name><name><surname>Mian</surname><given-names>IS</given-names></name><name><surname>Bissell</surname><given-names>MJ</given-names></name></person-group><article-title>Evaluation of normalization methods for cDNA microarray data by <italic>k</italic>-NN classification</article-title><source>BMC Bioinformatics</source><year>2005</year><volume>6</volume><fpage>191</fpage><pub-id pub-id-type="pmid">16045803</pub-id><pub-id pub-id-type="doi">10.1186/1471-2105-6-191</pub-id></citation></ref><ref id="B18"><citation citation-type="other"><person-group person-group-type="author"><collab>Axon Instruments Inc</collab></person-group><source>GenePix Pro 50: User's Guide and Tutorial</source><year>2003</year><ext-link ext-link-type="uri" xlink:href="http://www.moleculardevices.com"/></citation></ref></ref-list></back></article>


